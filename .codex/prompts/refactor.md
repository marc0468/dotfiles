このコードをクリーンコード原則に従ってリファクタリングしてください。

改善ポイント：
- 単一責任原則の適用
- 重複コードの排除
- 命名の改善
- 複雑度の削減
- テスタビリティの向上

変更前後の比較と、なぜその変更が必要かの説明も含めてください。
