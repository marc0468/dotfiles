選択したコードに対して包括的なユニットテストを作成してください。

テスト要件：
- 正常系のテストケース
- 異常系・エッジケース
- 境界値テスト
- モック・スタブの適切な使用

各テストケースには、何をテストしているかのコメントを付けてください。
